apiVersion: cli.kyverno.io/v1alpha1
kind: Test
metadata:
  name: inject-a2a-appprotocol
policies:
- ../../../platform/manifests/kyverno-a2a-appprotocol.yaml
resources:
- agent-service.yaml
- agent-service-no-annotation.yaml
- non-agent-service.yaml
results:
- policy: inject-a2a-appprotocol
  rule: add-a2a-appprotocol
  resources:
  - tenant-alpha/my-assistant
  kind: Service
  result: pass
  patchedResources: expected-mutated-service.yaml
- policy: inject-a2a-appprotocol
  rule: add-a2a-appprotocol
  resources:
  - tenant-alpha/unannotated-agent
  kind: Service
  result: skip
- policy: inject-a2a-appprotocol
  rule: add-a2a-appprotocol
  resources:
  - tenant-alpha/regular-service
  kind: Service
  result: skip
